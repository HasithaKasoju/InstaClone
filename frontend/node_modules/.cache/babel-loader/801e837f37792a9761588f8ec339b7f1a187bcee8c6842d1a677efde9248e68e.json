{"ast":null,"code":"import\"../css/CreatePost.css\";import profile from'../img/profile.jpg';import React,{useState,useEffect}from\"react\";import{toast}from'react-toastify';import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Createpost(){const[body,setBody]=useState(\"\");const[image,setImage]=useState(\"\");const[url,setUrl]=useState(\"\");const navigate=useNavigate();useEffect(()=>{// saving post to mongodb\nif(url){fetch(\"/CreatePost\",{method:\"post\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({body,pic:url})}).then(res=>res.json()).then(data=>{if(data.error){//notifyA(data.error)\nalert(\"add all fields\");return;}else{//notifyB(\"Successfully Posted\")\nnavigate(\"/home\");alert(\"Post uploaded\");}}).catch(err=>console.log(err));}},[url]);// posting image to cloudinary\nconst postDetails=()=>{console.log(body,image);const data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"hasitha2\");data.append(\"cloud_name\",\"hasitha2\");fetch(\"https://api.cloudinary.com/v1_1/hasitha2/image/upload\",{method:\"post\",body:data}).then(res=>res.json()).then(data=>setUrl(data.url)).catch(err=>console.log(err));};const loadfile=event=>{var output=document.getElementById(\"output\");output.src=URL.createObjectURL(event.target.files[0]);output.onload=function(){URL.revokeObjectURL(output.src);// free memory\n};};return/*#__PURE__*/_jsxs(\"div\",{className:\"createPost\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-header\",children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:\"3px auto\"},children:\"Create New Post\"}),/*#__PURE__*/_jsx(\"button\",{id:\"post-btn\",onClick:()=>{postDetails();},children:\"Share\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-div\",children:[/*#__PURE__*/_jsx(\"img\",{id:\"output\",src:\"https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-image-512.png\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:event=>{loadfile(event);setImage(event.target.files[0]);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-pic\",children:/*#__PURE__*/_jsx(\"img\",{src:profile,alt:\"\"})}),/*#__PURE__*/_jsx(\"h5\",{children:\"Hasitha\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:body,onChange:e=>{setBody(e.target.value);},type:\"text\",placeholder:\"Write a caption....\"})]})]});}","map":{"version":3,"names":["profile","React","useState","useEffect","toast","useNavigate","jsx","_jsx","jsxs","_jsxs","Createpost","body","setBody","image","setImage","url","setUrl","navigate","fetch","method","headers","localStorage","getItem","JSON","stringify","pic","then","res","json","data","error","alert","catch","err","console","log","postDetails","FormData","append","loadfile","event","output","document","getElementById","src","URL","createObjectURL","target","files","onload","revokeObjectURL","className","children","style","margin","id","onClick","type","accept","onChange","alt","value","e","placeholder"],"sources":["C:/Users/Administrator/Desktop/ha/backend/frontend/src/Screens/CreatePost.js"],"sourcesContent":["import \"../css/CreatePost.css\";\r\nimport profile from '../img/profile.jpg';\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { toast } from 'react-toastify';\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function Createpost() {\r\n  const [body, setBody] = useState(\"\");\r\n  const [image, setImage] = useState(\"\")\r\n  const [url, setUrl] = useState(\"\")\r\n  const navigate = useNavigate()\r\n  useEffect(() => {\r\n\r\n    // saving post to mongodb\r\n    if (url) {\r\n\r\n      fetch(\"/CreatePost\", {\r\n        method: \"post\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": \"Bearer \" + localStorage.getItem(\"jwt\")\r\n        },\r\n        body: JSON.stringify({\r\n          body,\r\n          pic: url\r\n        })\r\n      }).then(res => res.json())\r\n        .then(data => {\r\n          if (data.error) {\r\n            //notifyA(data.error)\r\n            alert(\"add all fields\");\r\n            return\r\n          } else {\r\n            //notifyB(\"Successfully Posted\")\r\n           navigate(\"/home\")\r\n          alert(\"Post uploaded\");\r\n          }\r\n        })\r\n        .catch(err => console.log(err))\r\n    }\r\n\r\n  }, [url])\r\n\r\n\r\n  // posting image to cloudinary\r\n  const postDetails = () => {\r\n \r\n    console.log(body, image)\r\n    const data = new FormData()\r\n    data.append(\"file\", image)\r\n    data.append(\"upload_preset\", \"hasitha2\")\r\n    data.append(\"cloud_name\", \"hasitha2\")\r\n    fetch(\"https://api.cloudinary.com/v1_1/hasitha2/image/upload\", {\r\n      method: \"post\",\r\n      body: data\r\n    }).then(res => res.json())\r\n      .then(data =>setUrl(data.url))\r\n      .catch(err => console.log(err))\r\n     \r\n     \r\n  }\r\n\r\n\r\n  const loadfile = (event) => {\r\n    var output = document.getElementById(\"output\");\r\n    output.src = URL.createObjectURL(event.target.files[0]);\r\n    output.onload = function () {\r\n      URL.revokeObjectURL(output.src); // free memory\r\n    };\r\n  };\r\n  return (\r\n    <div className=\"createPost\">\r\n      {/* //header */}\r\n      <div className=\"post-header\">\r\n        <h4 style={{ margin: \"3px auto\" }}>Create New Post</h4>\r\n        <button id=\"post-btn\" onClick={() => { postDetails() }}>Share</button>\r\n      </div>\r\n      {/* image preview */}\r\n      <div className=\"main-div\">\r\n        <img\r\n          id=\"output\"\r\n          src=\"https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-image-512.png\"\r\n        />\r\n        <input\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={(event) => {\r\n            loadfile(event);\r\n            setImage(event.target.files[0])\r\n          }}\r\n        />\r\n      </div>\r\n      {/* details */}\r\n      <div className=\"details\">\r\n        <div className=\"card-header\">\r\n          <div className=\"card-pic\">\r\n            <img\r\n              src={profile}\r\n              alt=\"\"\r\n            />\r\n          </div>\r\n          <h5>Hasitha</h5>\r\n        </div>\r\n        <textarea value={body} onChange={(e) => {\r\n          setBody(e.target.value)\r\n        }} type=\"text\" placeholder=\"Write a caption....\"></textarea>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}