{"ast":null,"code":"import React,{useEffect,useState}from'react';import profile from'../img/profile.jpg';import'../css/Profile.css';import{useNavigate}from'react-router-dom';import Postdetails from'./Postdetails';import ProfilePic from'./ProfilePic';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){const[data,setData]=useState([]);const[show,setShow]=useState(false);const[posts,setPosts]=useState([]);const[changePic,setChangePic]=useState(false);const navigate=useNavigate();const[user,setUser]=useState(\"\");const notifyB=message=>alert(message);const userId=JSON.parse(localStorage.getItem('user'))._id;console.log(\"ID : \",userId);const toggledetails=posts=>{console.log(\"toggledetails function called\",posts);setShow(!show);if(!show)setPosts(posts);};const deletePostFromState=postId=>{setData(data.filter(post=>post._id!==postId));};const changeprofile=()=>{setChangePic(!changePic);};const fetchUserData=()=>{fetch(\"/user/\".concat(userId),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(res=>res.json()).then(result=>{setUser(result.user);// Set user data from the response\nsetData(result.posts);}).catch(err=>console.log(err));};useEffect(()=>{fetchUserData();},[]);// Fetch data again when profile picture is changed\nuseEffect(()=>{if(!changePic){fetchUserData();}},[changePic]);return/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-frame\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-pic\",children:/*#__PURE__*/_jsx(\"img\",{onClick:changeprofile,src:user.Photo?user.Photo:profile,alt:\"profile\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-data\",children:[/*#__PURE__*/_jsx(\"h1\",{children:JSON.parse(localStorage.getItem('user')).name}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",style:{display:'flex',justifyContent:'space-around'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[data.length,\" posts\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user.followers?user.followers.length:\"0\",\" followers\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user.following?user.following.length:\"0\",\" following\"]})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{style:{width:\"90%\",margin:\"auto\",opacity:\"0.8\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:data.map(pic=>/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:/*#__PURE__*/_jsx(\"img\",{src:pic.photo,onClick:()=>toggledetails(pic),alt:\"post\"})},pic._id))}),show&&/*#__PURE__*/_jsx(Postdetails,{item:posts,toggledetails:toggledetails,onDelete:deletePostFromState}),changePic&&/*#__PURE__*/_jsx(ProfilePic,{changeprofile:changeprofile})]});}","map":{"version":3,"names":["React","useEffect","useState","profile","useNavigate","Postdetails","ProfilePic","jsx","_jsx","jsxs","_jsxs","Profile","data","setData","show","setShow","posts","setPosts","changePic","setChangePic","navigate","user","setUser","notifyB","message","alert","userId","JSON","parse","localStorage","getItem","_id","console","log","toggledetails","deletePostFromState","postId","filter","post","changeprofile","fetchUserData","fetch","concat","headers","then","res","json","result","catch","err","className","children","onClick","src","Photo","alt","name","style","display","justifyContent","length","followers","following","width","margin","opacity","map","pic","photo","item","onDelete"],"sources":["C:/Users/Administrator/Desktop/ha/backend/frontend/src/Screens/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport profile from '../img/profile.jpg';\r\nimport '../css/Profile.css';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Postdetails from './Postdetails';\r\nimport ProfilePic from './ProfilePic';\r\n\r\nexport default function Profile() {\r\n  const [data, setData] = useState([]);\r\n  const [show, setShow] = useState(false);\r\n  const [posts, setPosts] = useState([]);\r\n  const [changePic, setChangePic] = useState(false);\r\n  const navigate = useNavigate();\r\n  const [user, setUser] = useState(\"\");\r\n  const notifyB = (message) => alert(message);\r\n  const userId = JSON.parse(localStorage.getItem('user'))._id;\r\n  console.log(\"ID : \", userId);\r\n\r\n  const toggledetails = (posts) => {\r\n    console.log(\"toggledetails function called\", posts);\r\n    setShow(!show);\r\n    if (!show) setPosts(posts);\r\n  };\r\n\r\n  const deletePostFromState = (postId) => {\r\n    setData(data.filter(post => post._id !== postId));\r\n  };\r\n\r\n  const changeprofile = () => {\r\n    setChangePic(!changePic);\r\n  };\r\n\r\n  const fetchUserData = () => {\r\n    fetch(`/user/${userId}`, {\r\n      headers: {\r\n        \"Authorization\": \"Bearer \" + localStorage.getItem(\"jwt\")\r\n      }\r\n    })\r\n      .then(res => res.json())\r\n      .then((result) => {\r\n        setUser(result.user); // Set user data from the response\r\n        setData(result.posts);\r\n      })\r\n      .catch(err => console.log(err));\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  // Fetch data again when profile picture is changed\r\n  useEffect(() => {\r\n    if (!changePic) {\r\n      fetchUserData();\r\n    }\r\n  }, [changePic]);\r\n\r\n  return (\r\n    <div className=\"profile\">\r\n      <div className=\"profile-frame\">\r\n        <div className=\"profile-pic\">\r\n          <img onClick={changeprofile} src={user.Photo ? user.Photo : profile} alt=\"profile\" />\r\n        </div>\r\n        <div className=\"profile-data\">\r\n          <h1>{JSON.parse(localStorage.getItem('user')).name}</h1>\r\n          <div className=\"profile-info\" style={{ display: 'flex', justifyContent: 'space-around' }}>\r\n            <p>{data.length} posts</p>\r\n            <p>{user.followers ? user.followers.length : \"0\"} followers</p>\r\n            <p>{user.following ? user.following.length : \"0\"} following</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <hr style={{ width: \"90%\", margin: \"auto\", opacity: \"0.8\" }} />\r\n      <div className=\"gallery\">\r\n        {data.map((pic) => (\r\n          <div key={pic._id} className=\"post\">\r\n            <img \r\n              src={pic.photo} \r\n              onClick={() => toggledetails(pic)} \r\n              alt=\"post\" \r\n            />\r\n          </div>\r\n        ))}\r\n      </div>\r\n      {show && <Postdetails item={posts} toggledetails={toggledetails} onDelete={deletePostFromState} />}\r\n      {changePic && <ProfilePic changeprofile={changeprofile} />}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}